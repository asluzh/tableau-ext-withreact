import{j as e,t as d,r as i,d as h,c as m,R as y}from"./settings-C6THL_L0.js";function E({dashboard:u,settings:a}){return e.jsx(e.Fragment,{children:e.jsx("div",{className:"centerOnPage",children:e.jsx(d.Button,{kind:a.buttonStyle,disabled:!1,onClick:()=>{console.log("Button clicked")},children:a.buttonLabel})})})}const c=!1;function j(){const[u,a]=i.useState({}),[r,g]=i.useState(0),[b,p]=i.useState({});i.useEffect(()=>((async()=>{await tableau.extensions.initializeAsync({configure:x}),a(tableau.extensions.dashboardContent.dashboard);const n=tableau.extensions.settings.getAll();Object.keys(n).length>0?(await new Promise(t=>setTimeout(t,1e3)),l(n)):g(1)})(),()=>{}),[]);function l(n){try{const t={...h};c&&console.log("[ExtensionWrapper.tsx] Validating extension settings"),"metaVersion"in n&&parseInt(n.metaVersion)&&(t.metaVersion=parseInt(n.metaVersion),t.buttonLabel=n.buttonLabel,t.buttonStyle=n.buttonStyle,p(t),g(2))}catch(t){console.error("Error updating settings:",t)}}const x=()=>{let n="config.html";const t=tableau.extensions.environment.tableauVersion.split(".");if(parseInt(t[0],10)===2018||parseInt(t[0],10)===2019&&parseInt(t[1],10)<3){const o=window.location.href;n=window.location.href.substring(0,o.lastIndexOf("/"))+"/config.html"}(async()=>{const o=tableau.extensions.settings.addEventListener(tableau.TableauEventType.SettingsChanged,s=>{l(tableau.extensions.settings.getAll())});try{const s=await tableau.extensions.ui.displayDialogAsync(n,"",{height:650,width:500});if(c&&console.log(`[ExtensionWrapper.tsx] Returning from config window (${s})`),s&&o===void 0){c&&console.log("[ExtensionWrapper.tsx] Update settings without listener");const f=tableau.extensions.settings.getAll();l(f)}}catch(s){if(typeof s=="object"&&s!==null&&"errorCode"in s)switch(s.errorCode){case tableau.ErrorCodes.DialogClosedByUser:break;default:console.error("[ExtensionWrapper.tsx]",s)}}finally{o&&o()}})()};return e.jsxs(e.Fragment,{children:[r===0&&e.jsx("div",{"aria-busy":"true",className:"overlay",children:e.jsx("div",{className:"centerOnPage",children:e.jsx(d.Spinner,{color:"dark"})})}),r===1&&e.jsx("div",{className:"centerOnPage",children:e.jsx(d.Button,{kind:"outline",onClick:x,children:"Configure Extension"})}),r===2&&e.jsx(E,{dashboard:u,settings:b})]})}m.createRoot(document.getElementById("root")).render(e.jsx(y.StrictMode,{children:e.jsx(j,{})}));
